# JS Aho-Corasick Matcher

AC 自动机多关键字字符串搜索算法的简单实现。

## AC 自动机搜索算法简介

AC 自动机搜索算法用于快速一次同时搜索多个关键字。

### 简单思想

AC 自动机搜索的简单思想：

1. 一次同时搜索多个关键字；
2. 多个关键字之间存在相同的部分，比如 "abcd", "bcw" 两个关键字的 "bc" 是相同的地方；
3. 用关键子构建一个前缀树，树的节点是关键字的字符，树的每条分支就是关键字，因为关键字之间有相同的部分，所以分支之间有可能有共用的地方；
4. 为每个节点设置一个匹配失败后的指针，用于当搜索某个关键字进行到一半而失败时，该跳转的节点，比如 "abcd" 的 "c" 的失败指针应该指向 "bcw" 的 "c"，因为它们有相同的 **前缀**；
5. 假设当前的被搜索的字符串是 "abcw"，一开始会沿着 "abcd" 分支的节点前进，当搜索到 "w" 时，当前节点是关键字 "abcd" 的 "c"，但它的子节点只有 "d" 而没有 "w"，所以这时会改道到失败指针指向的 "bcw" 分支的 "c"，然后再查看其子节点是否存在 "w"；
6. 因为失败指针指向的节点（注意它已经是另外一个关键字的分支上的节点）跟之前的节点有相同的前缀，所以被搜索字符串（的位置指针）不需要回退，而搜索指针也不需要从根节点开始，这正是 AC 自动机搜索能快速的原因。

具体过程见代码 [aho-corasik.js](src/aho-corasick.js) 和 [trie-tree.js](src/trie-tree.js)。

## 单元测试

执行命令：

`$ npm test`

应该能看到 `testAhoCorasick() passed.` 字样。

## 单步调试/跟踪

有时可能跟踪程序的运行也能帮助对程序的理解，启动单步调试的方法是：

在 vscode 里打开该项目，然后在单元测试文件 [test-all.js](./test/test-all.js) 或者源码 [aho-corasick.js](./src/aho-corasick.js) 里设置断点，然后执行 `Run and Debug` 即可。
